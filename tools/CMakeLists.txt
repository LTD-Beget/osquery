set(CMAKE_MODULE_LINKER_FLAGS "-Wl,--no-as-needed")
set(CMAKE_EXE_LINKER_FLAGS "-Wl,--no-as-needed")

ADD_EXECUTABLE(flag_test flag_test.cpp)
TARGET_LINK_LIBRARIES(flag_test gflags glog)
SET_TARGET_PROPERTIES(flag_test PROPERTIES COMPILE_FLAGS ${OS_COMPILE_FLAGS})

ADD_EXECUTABLE(registry_test registry_test.cpp)
TARGET_LINK_LIBRARIES(registry_test osquery_shared)
SET_TARGET_PROPERTIES(registry_test PROPERTIES COMPILE_FLAGS ${OS_COMPILE_FLAGS})
ADD_TEST(registry_test registry_test)

ADD_EXECUTABLE(run run.cpp)
TARGET_LINK_LIBRARIES(run osquery_shared)
SET_TARGET_PROPERTIES(run PROPERTIES COMPILE_FLAGS ${OS_COMPILE_FLAGS})

